# Appleç”Ÿæˆ `*.p12`æ–‡ä»¶

[toc]

## ä¸€ã€ä»€ä¹ˆæ˜¯`*.p12`æ–‡ä»¶ï¼Ÿ

* `.p12` æ–‡ä»¶å…¨ç§° **PKCS#12 (Personal Information Exchange)**
* å®ƒé‡Œé¢åŒæ—¶æ‰“åŒ…äº†ï¼š
  - **è¯ä¹¦ (.cer)**
  - **ç§é’¥ (.key)**
* å¹¶ä¸”é€šå¸¸ä¼šæœ‰ä¸€ä¸ªå¯¼å‡ºå¯†ç ä¿æŠ¤ã€‚

## äºŒã€`*.p12`æ–‡ä»¶çš„ç”¨å¤„

> âš ï¸ æ³¨æ„äº‹é¡¹
>
> - `.p12` ä¸€å®šè¦å®‰å…¨ä¿å­˜ï¼Œæ³„éœ²å‡ºå»åˆ«äººå°±èƒ½ç”¨å®ƒä¼ªé€ æ¨é€æˆ–ç­¾åã€‚
> - å¯¼å‡ºçš„æ—¶å€™ç³»ç»Ÿä¼šå¼ºåˆ¶ä½ è®¾ç½®ä¸€ä¸ªå¯†ç ï¼ˆä¿æŠ¤ p12ï¼‰ï¼ŒæœåŠ¡ç«¯ä¹Ÿéœ€è¦è¿™ä¸ªå¯†ç æ‰èƒ½è§£å¯†ä½¿ç”¨ã€‚

*  **iOS æ¨é€é€šçŸ¥ (APNs)**
  * å¦‚æœä½ åšæ¨é€æœåŠ¡ï¼ˆæ¯”å¦‚æå…‰ã€ç¯ä¿¡ã€Firebaseã€EngageLabã€OpenInstallï¼‰ï¼Œåå°éƒ½è¦ä¸Šä¼  `.p12`ã€‚
  * ä½œç”¨ï¼šæœåŠ¡å™¨æ‹¿ `.p12` å»è·Ÿ Apple APNs å»ºç«‹åŠ å¯†è¿æ¥ï¼Œä»è€Œèƒ½æ¨é€æ¶ˆæ¯åˆ°ç”¨æˆ· iPhoneã€‚
* App ç­¾å / åˆ†å‘
  * åœ¨ä¸€äº›ç¬¬ä¸‰æ–¹å¹³å°ï¼ˆæ¯”å¦‚ CI/CDã€MDM ç®¡ç†å¹³å°ï¼‰ï¼Œä¸Šä¼  `.p12` + **Provisioning Profile**ï¼Œå®ƒä»¬å°±èƒ½è‡ªåŠ¨å¸®ä½ ç­¾å ipa åŒ…ã€‚
  * å› ä¸ºç­¾åéœ€è¦è¯ä¹¦ + ç§é’¥ï¼Œè€Œ `.p12` å°±æ˜¯æ‰“åŒ…å¥½çš„ã€‚
* è·¨å¹³å°è¯ä¹¦ç§»äº¤
  * å¦‚æœä½ æ¢äº† Macï¼Œæ²¡æ³•ç›´æ¥è¿ç§»é’¥åŒ™ä¸²ï¼Œå¯ä»¥ç›´æ¥å¯¼å‡º `.p12`ï¼Œåœ¨æ–° Mac ä¸Šå¯¼å…¥ï¼Œå°±èƒ½ç»§ç»­ä½¿ç”¨åŒä¸€ä¸ªè¯ä¹¦å’Œç§é’¥ã€‚

## ä¸‰ã€ç”Ÿæˆæµç¨‹

### 1ã€æ‰“å¼€ï¼šé’¥åŒ™ä¸²è®¿é—® (Keychain Access)ğŸ”‘

> åæœŸçš„MacOSå°†â€œé’¥åŒ™ä¸²â€å½’ä¸ºâ€œå¯†ç â€

* ä¹‹å‰çš„è€ç‰ˆæœ¬MacOSç³»ç»Ÿè‡ªå¸¦æœ‰ç‹¬ç«‹çš„ `é’¥åŒ™ä¸²è®¿é—® (Keychain Access)`åº”ç”¨ç¨‹åºå…¥å£ï¼Œäº¦å¯ä»¥ç”¨å‘½ä»¤è¡Œæ–¹å¼æ‰“å¼€

  ```shell
  open -a "Keychain Access"
  ```

* ç›®å‰æœ€æ–°ç‰ˆçš„MacOSç³»ç»Ÿè¿›å…¥`é’¥åŒ™ä¸²è®¿é—® (Keychain Access)`çš„æ–¹å¼

  ```shell
  open /System/Library/CoreServices/Applications/
  ```

  ![image-20250908203759555](./assets/image-20250908203759555.png)

### 2ã€ä»è¯ä¹¦é¢å‘æœºæ„è¯·æ±‚è¯ä¹¦

> è¾“å…¥é‚®ç®±ã€å¸¸ç”¨åç§°ï¼Œé€‰æ‹© â€œå­˜å‚¨åˆ°ç£ç›˜â€ï¼Œå¾—åˆ° `.certSigningRequest` æ–‡ä»¶

<p align="center">
  <img src="./assets/image-20250908204209857.png" alt="å›¾1" width="33%"/>
  <img src="./assets/image-20250908204430358.png" alt="å›¾2" width="33%"/>
  <img src="./assets/image-20250908204740854.png" alt="å›¾2" width="33%"/>
</p>

### 3ã€åœ¨ [**Apple Developer**](https://developer.apple.com/) ç”Ÿæˆ `.cer`

> ç‰¹æ®Šåœ°åŒºéœ€è¦æ‰“å¼€VPNï¼Œè‹¹æœå®˜ç½‘é™åˆ¶æŸäº›åœ°åŒºçš„IPç™»å½• [**Apple Developer**](https://developer.apple.com/) 

* è¿›å…¥ **Certificates** â†’ åˆ›å»ºæ–°è¯ä¹¦

  <img src="./assets/image-20250908210345356.png" alt="image-20250908210345356" style="zoom:50%;" />

* æ ¹æ®éœ€æ±‚é€‰æ‹©

  - **Apple Push Notification service SSL (Sandbox & Production)**ï¼ˆæ¨é€ï¼‰

    <img src="./assets/image-20250908210535170.png" alt="image-20250908210535170" style="zoom:50%;" />

  - **Apple Distribution**ï¼ˆå‘å¸ƒ Appï¼‰

    <img src="./assets/image-20250908210656910.png" alt="image-20250908210656910" style="zoom:50%;" />

  - å…¶ä»–ç”¨é€”çš„è¯ä¹¦...

* ä¸Šä¼ åˆšæ‰ç”Ÿæˆçš„ `*.certSigningRequest`ï¼ˆç³»ç»Ÿé»˜è®¤ç”Ÿæˆï¼š`CertificateSigningRequest.certSigningRequest`ï¼‰

  ![image-1](./assets/image-20250908211018574.png)
  ![image-2](./assets/image-20250908211109221.png)
  ![image-3](./assets/image-20250908211440077.png)


* ä¸‹è½½ç”Ÿæˆçš„ `.cer` æ–‡ä»¶ï¼ˆ`aps.cer`ï¼‰

  

  ![image-20250908211508056](./assets/image-20250908211508056.png)

### 4ã€å¯¼å…¥ `.cer` å¹¶å¯¼å‡ºç§é’¥

* åŒå‡» `.cer` æ–‡ä»¶å¯¼å…¥åˆ° **é’¥åŒ™ä¸²**

  <img src="./assets/image-20250908211800003.png" alt="image-20250908211800003" style="zoom:50%;" />

* ä»¥ä¸Šä¸‰ä¸ªé€‰é¡¹çš„åŒºåˆ«

  * **ç™»å½• (Login)**ï¼š âœ… æœ€å¸¸ç”¨ï¼Œå­˜æ”¾å’Œä½ å½“å‰ç”¨æˆ·ç»‘å®šçš„ç§é’¥å’Œè¯ä¹¦ã€‚å¦‚æœåé¢è¦å¯¼å‡º `.p12` ç»™æœåŠ¡ç«¯ç”¨ï¼ˆæ¯”å¦‚æ¨é€è¯ä¹¦ï¼‰ï¼Œå¿…é¡»é€‰è¿™ä¸ªã€‚
  * **iCloud**ï¼šä¼šåŒæ­¥åˆ° iCloud é’¥åŒ™ä¸²ï¼Œä¸€èˆ¬ä¸ç”¨æ¥å­˜å¼€å‘/æ¨é€è¯ä¹¦ã€‚
  * **ç³»ç»Ÿ (System)**ï¼šé¢å‘æ•´ä¸ªç³»ç»Ÿçš„æ ¹è¯ä¹¦/å—ä¿¡ä»» CAï¼Œä¸é€‚åˆå­˜ä½ çš„å¼€å‘/æ¨é€è¯ä¹¦ã€‚

* é’¥åŒ™ä¸²é‡Œæ‰¾åˆ°è¯¥è¯ä¹¦ï¼ˆé€šå¸¸åœ¨ *æˆ‘çš„è¯ä¹¦* æ ‡ç­¾ä¸‹ï¼Œä¼šå’Œç§é’¥æˆå¯¹å‡ºç°ï¼‰

  ![image-20250908212210020](./assets/image-20250908212210020.png)

  ![image-20250908212254989](./assets/image-20250908212254989.png)

* å³é”®å¯¼å‡º`*.p12`ï¼ˆ**æ­¤æ­¥éª¤éœ€è¦è¾“å…¥MacOSç”µè„‘çš„å¼€æœºå¯†ç **ï¼‰

  ![image-20250908212639049](./assets/image-20250908212639049.png)

  ![image-20250908212704967](./assets/image-20250908212704967.png)

